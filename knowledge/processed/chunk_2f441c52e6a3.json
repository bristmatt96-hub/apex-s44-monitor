{
  "id": "2f441c52e6a3",
  "source": "Quantitative_Trading.pdf",
  "source_type": "pdf",
  "title": "Quantitative Trading",
  "chunk_index": 37,
  "content": "and PEP is the same as that for GDX and GLD in Example 7.2, so it won\u2019t be repeated here. (It is available from epchan.com/book/example7_3.m.) The cointegration result shows that the t-statistic for the augmented Dicky-Fuller test is \u20132.14, larger than the 10 percent critical value of \u20133.038, meaning that there is a less than 90 percent probability that these two time series are cointegrated. Chan800064_c07.indd 155 6/7/2021 7:16:57 AM Special Topics in Quantitative Trading 155 Can we find a real-life example of this phenomenon? Well, KO versus PEP is one. In the program example7_3.m, I have shown that they do not cointegrate. If, however, you test their daily returns for correlation, you will find that their correlation of 0.4849 is indeed statistically significant. The correlation test is presented at the end of the example7_3.m program and shown here in Example 7.3. Stock A Stock B 73 72 71 70 69 68 Daily Prices67 66 65 64 6305 10 15 20 Days 25 30 35 40 45 FIGURE 7.4 Cointegration is not correlation. Stocks A and B are cointegrated but not correlated. Example 7.3: Testing the Cointegration versus Correlation Properties between KO and PEP The cointegration test for KO and PEP is the same as that for GDX and GLD in Example 7.2, so it won\u2019t be repeated here. (It is available from epchan.com/book/example7_3.m.) The cointegration result shows that the t-statistic for the augmented Dicky-Fuller test is \u20132.14, larger than the 10 percent critical value of \u20133.038, meaning that there is a less than 90 percent probability that these two time series are cointegrated. Chan800064_c07.indd 155 6/7/2021 7:16:57 AM I= 78 This PDF file is part of the audiobook QUANTITATIVE TRADING and cannot be sold separately. It may not be reproduced, copied, circulated, or posted online. All rights reserved. Copyright \u00a9 Ernest P . Chan, 2021. Published by Echo Point Books & Media, LLC by arrangement with John Wiley & Sons, Inc. All Rights Reserved. 156 QUANTITATIVE TRADING The following code fragment, however, tests for correlation between the two time series: Using MATLAB You can download the MATLAB code as example7_3.m. % A test for correlation. dailyReturns=(adjcls-lag1(adjcls))./lag1(adjcls); [R,P]=corrcoef(dailyReturns(2:end,:)); % R = % % 1.0000 0.4849 % 0.4849 1.0000 % % % P = % % 1 0 % 0 1 % The P value of 0 indicates that the two time series % are significantly correlated. Using Python You can download the Python Jupyter notebook as example7_3.ipynb. How to Form a Good Cointegrating (and Mean-Reverting) Pair of Stocks import numpy as np import pandas as pd import matplotlib.pyplot as plt from statsmodels.tsa.stattools import coint from statsmodels.api import OLS from scipy.stats import pearsonr df1=pd.read_excel('KO.xls') df2=pd.read_excel('PEP.xls') df=pd.merge(df1, df2, on='Date', suffixes=('_KO', '_PEP')) df.set_index('Date', inplace=True) df.sort_index(inplace=True) Run cointegration (Engle-Granger) test coint_t, pvalue, crit_value=coint(df['Adj Close_KO'], df['Adj Close_PEP']) (coint_t, pvalue, crit_value) # abs(t-stat) < critical value at 90%. pvalue says probability of null hypothesis (of no cointegration) is 73% (-1.5815517041517178, 0.7286134576473527, array([-3.89783854, -3.33691006, -3.04499143])) Chan800064_c07.indd 156 6/7/2021 7:16:57 AM 79 This PDF file is part of the audiobook QUANTITATIVE TRADING and cannot be sold separately. It may not be reproduced, copied, circulated, or posted online. All rights reserved. Copyright \u00a9 Ernest P . Chan, 2021. Published by Echo Point Books & Media, LLC by arrangement with John Wiley & Sons, Inc. All Rights Reserved. Special Topics in Quantitative Trading 157 Determine hedge ratio model=OLS(df['Adj Close_KO'], df['Adj Close_PEP']) results=model.fit() hedgeRatio=results.params hedgeRatio Adj Close_PEP 1.011409 dtype: float64 spread = KO - hedgeRatio*PEP spread=df['Adj Close_KO']-hedgeRatio[0]*df['Adj Close_PEP'] plt.plot(spread) # Figure 7.2 [<matplotlib.lines.Line2D at 0x2728e431b00>] png png Correlation test dailyret=df.loc[:, ('Adj Close_KO', 'Adj Close_PEP')]. pct_change() dailyret.corr() Adj Close_KO Adj Close_PEP Adj Close_KO 1.000000 0.484924 Adj Close_PEP 0.484924 1.000000 dailyret_clean=dailyret.dropna() pearsonr(dailyret_clean.iloc[:,0], dailyret_clean. iloc[:,1]) # first output is correlation coefficient, second output is pvalue. (0.4849239439370571, 0.0) Using R You can download the R code as example7_3.R. # Need the zoo package for its na.locf function # install.packages('zoo') # Need the CADFtest package for its CADFtest function # install.packages('CADFtest') library('zoo') library('CADFtest') source('calculateReturns.R') data1 <- read.delim(\"KO.txt\") # Tab-delimited data_sort1 <- data1[order(as.Date(data1[,1], '%m/%d/%Y')),] # sort in ascending order of dates (1st column of data) Chan800064_c07.indd 157 6/7/2021 7:16:57 AM 80 This PDF file is part of the audiobook QUANTITATIVE TRADING and cannot be sold separately. It may not be reproduced, copied, circulated, or posted online. All rights reserved. Copyright \u00a9 Ernest P . Chan, 2021. Published by Echo Point Books & Media, LLC by arrangement with John Wiley & Sons, Inc. All Rights Reserved. 158 QUANTITATIVE TRADING tday1 <- as.integer(format(as.Date(data_sort1[,1], '%m/%d/%Y'), '%Y%m%d')) adjcls1 <- data_sort1[,ncol(data_sort1)] data2 <- read.delim(\"PEP.txt\") # Tab-delimited data_sort2 <- data2[order(as.Date(data2[,1], '%m/%d/%Y')),] # sort in ascending order of dates (1st column of data) tday2 <- as.integer(format(as.Date(data_sort2[,1], '%m/%d/%Y'), '%Y%m%d')) adjcls2 <- data_sort2[,ncol(data_sort2)] # find the intersection of the two data sets tday <- intersect(tday1, tday2) adjcls1 <- adjcls1[tday1 %in% tday] adjcls2 <- adjcls2[tday2 %in% tday] # CADFtest cannot have NaN values in input adjcls1 <- zoo::na.locf(adjcls1) adjcls2 <- zoo::na.locf(adjcls2) mydata <- list(KO=adjcls1, PEP=adjcls2); res <- CADFtest(model=KO~PEP, data=mydata, type = \"drift\", max.lag.X=1) summary(res) # As the following input shows, p-value is about 0.16, hence we cannot reject null hypothesis. # Covariate Augmented DF test # CADF test # t-test statistic: -2.2255225 # estimated rho^2: 0.8249085 # p-value: 0.1612782 # Max lag of the diff. dependent variable: 1.0000000 # Max lag of the stationary covariate(s): 1.0000000 # Max lead of the stationary covariate(s): 0.0000000 # # Call: # dynlm(formula = formula(model), start = obs.1, end = obs.T) # # Residuals: # Min 1Q Median 3Q Max # -4.7552 -0.0694 -0.0059 0.0576 4.5976 # # Coefficients: # Estimate Std. Error t value Pr(>|t|) # (Intercept) 0.0060546 0.0071439 0.848 0.397 # L(y, 1) -0.0011457 0.0005148 -2.226 0.161 # L(d(y), 1) 0.0518074 0.0102210 5.069 4.1e-07 *** Chan800064_c07.indd 158 6/7/2021 7:16:57 AM 81 This PDF file is part of the audiobook QUANTITATIVE TRADING and cannot be sold separately. It may not be reproduced, copied, circulated, or posted online. All rights reserved. Copyright \u00a9 Ernest P . Chan, 2021. Published by Echo Point Books & Media, LLC by arrangement with John Wiley",
  "word_count": 1000,
  "topics": [
    "options",
    "market_structure",
    "forex"
  ],
  "created_at": "2026-02-05T00:37:43.609729"
}